const t=new class{constructor(t=null){this.board=t||this.createEmptyBoard(),this.score=0,this.status="running",this.spawnTile()}createEmptyBoard(){return Array.from({length:4},()=>[,,,,].fill(0))}getState(){return this.board}getScore(){return this.score}getStatus(){return this.status}spawnTile(){let t=[];if(this.board.forEach((e,s)=>{e.forEach((e,r)=>{0===e&&t.push([s,r])})}),0===t.length)return;let[e,s]=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.9>Math.random()?2:4}moveLeft(){let t=!1;for(let e of this.board){let s=[...e];this.merge(e),this.hasChanged(s,e)&&(t=!0)}t&&(this.spawnTile(),this.checkGameStatus())}moveRight(){this.board.forEach(t=>t.reverse()),this.moveLeft(),this.board.forEach(t=>t.reverse())}moveUp(){this.transpose(),this.moveLeft(),this.transpose()}moveDown(){this.transpose(),this.moveRight(),this.transpose()}transpose(){this.board=this.board[0].map((t,e)=>this.board.map(t=>t[e]))}merge(t){for(let e=0;e<4;e++){if(0===t[e])continue;let s=e+1;for(;s<4&&0===t[s];)s++;s<4&&t[e]===t[s]&&(t[e]*=2,this.score+=t[e],t[s]=0)}let e=t.filter(t=>0!==t);for(;e.length<4;)e.push(0);for(let s=0;s<4;s++)t[s]=e[s]}hasChanged(t,e){return JSON.stringify(t)!==JSON.stringify(e)}checkGameStatus(){this.board.flat().includes(2048)?this.status="won":!this.board.flat().includes(0)&&this.noValidMoves()&&(this.status="lost")}noValidMoves(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.board[t][e]||e<3&&this.board[t][e]===this.board[t][e+1]||t<3&&this.board[t][e]===this.board[t+1][e])return!1;return!0}start(){this.board=this.createEmptyBoard(),this.score=0,this.status="running",this.spawnTile(),this.spawnTile()}restart(){this.start()}},e=document.querySelector(".game-score"),s=document.querySelector(".message-start"),r=document.querySelector(".message-win"),o=document.querySelector(".message-lose"),a=document.querySelector(".start");function i(){document.querySelectorAll(".field-cell").forEach((e,s)=>{let r=t.getState()[Math.floor(s/4)][s%4];e.className="field-cell"+(r?` field-cell--${r}`:""),e.textContent=r||""}),e.textContent=t.getScore(),"won"===t.getStatus()?r.classList.remove("hidden"):"lost"===t.getStatus()&&o.classList.remove("hidden")}document.addEventListener("keydown",e=>{if("running"===t.getStatus()){switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}i()}}),a.addEventListener("click",()=>{t.start(),s.classList.add("hidden"),a.textContent="Restart",i()}),i();
//# sourceMappingURL=index.80e67f4c.js.map
